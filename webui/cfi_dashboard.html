<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>CFI Dashboard ‚Äî BenchmarkOS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="cfi_dashboard.css?v=20241024b"/>
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
</head>
<body>
  <div id="cfi-root" class="cfi-grid">
    <!-- Improvement #9: Dashboard Navigation Toolbar -->
    <div class="dashboard-toolbar">
      <div class="toolbar-left">
        <select id="dashboard-switcher" class="dashboard-switcher" aria-label="Switch dashboard view">
          <option value="cfi-classic">Single Company View</option>
          <option value="cfi-compare">Multi-Company Compare</option>
          <option value="cfi-dense">Compact View</option>
        </select>
        <!-- Improvement #2: Search/Filter -->
        <div class="search-container">
          <input type="search" id="dashboard-search" class="dashboard-search" placeholder="Search metrics..." aria-label="Search metrics">
          <span class="search-icon">üîç</span>
        </div>
      </div>
      <div class="toolbar-right">
        <!-- Improvement #1: Real-time indicators -->
        <div class="data-freshness" id="data-freshness">
          <span class="freshness-dot fresh"></span>
          <span class="freshness-text">Updated just now</span>
        </div>
        <button type="button" class="toolbar-button" id="refresh-dashboard" aria-label="Refresh data" title="Refresh data (R)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
          </svg>
        </button>
        <button type="button" class="toolbar-button" id="show-shortcuts" aria-label="Keyboard shortcuts" title="Keyboard shortcuts (?)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="cfi-panel cfi-header" data-area="header">
      <div class="header-top">
        <div class="brand-stack">
          <div class="brand-row">
            <span class="brand-badge" id="cfi-brand"></span>
            <span class="brand-ticker" id="cfi-ticker"></span>
          </div>
          <div class="brand-company" id="cfi-company"></div>
        </div>
        <div class="header-title">
          <h1>Financial Model Dashboard</h1>
          <div class="header-meta">
            <div class="meta-item">
              <span class="meta-label">Recommendation</span>
              <span class="meta-value pill" id="cfi-rec"></span>
            </div>
            <div class="meta-item">
              <span class="meta-label">Target Price</span>
              <span class="meta-value" id="cfi-target"></span>
            </div>
            <div class="meta-item">
              <span class="meta-label">Live Scenario</span>
              <span class="meta-value" id="cfi-scenario"></span>
            </div>
          </div>
        </div>
        <div class="header-actions">
          <button type="button" class="export-button" data-export-format="pdf">Export PDF</button>
          <button type="button" class="export-button" data-export-format="pptx">Export PPTX</button>
          <button type="button" class="export-button" data-export-format="xlsx">Export Excel</button>
        </div>
        <div class="header-side">
          <div class="meta-item">
            <span class="meta-label">Date</span>
            <span class="meta-value" id="cfi-date"></span>
          </div>
          <div class="cfi-logo">CFI</div>
        </div>
      </div>
      <div class="header-subline">
        <span id="cfi-website"></span>
        <span id="cfi-report-tag"></span>
      </div>
    </div>

    <div class="cfi-panel" data-area="overview">
      <div class="cfi-strip">Company Overview</div>
      <div class="cfi-body tight">
        <div class="overview-grid">
          <div class="overview-column">
            <h3>Price</h3>
            <table class="overview-table" id="cfi-price-table"></table>
          </div>
          <div class="overview-column">
            <h3>Key Stats</h3>
            <table class="overview-table" id="cfi-stat-table"></table>
          </div>
          <div class="overview-column">
            <h3>Market Data</h3>
            <table class="overview-table" id="cfi-market-table"></table>
          </div>
        </div>
      </div>
    </div>

    <div class="cfi-panel" data-area="valuation">
      <div class="cfi-strip">Valuation</div>
      <div class="cfi-body tight">
        <div class="valuation-grid">
          <table class="valuation-table" id="cfi-valuation-table"></table>
          <ul class="valuation-list" id="cfi-valuation-notes"></ul>
        </div>
      </div>
    </div>

    <div class="cfi-panel" data-area="keyfin">
      <div class="cfi-strip">Key Financials</div>
      <div id="cfi-keyfin" class="cfi-body tight"></div>
    </div>
    <!-- Improvement #8: Grouped KPI Scorecard -->
    <div class="cfi-panel" data-area="kpi">
      <div class="cfi-strip">
        KPI Scorecard
        <button class="strip-action" id="toggle-all-kpis" title="Expand/Collapse All">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
      </div>
      <div id="cfi-kpi" class="cfi-body tight">
        <!-- Improvement #4: Loading state -->
        <div class="skeleton-kpi-grid">
          <div class="skeleton-kpi-item"></div>
          <div class="skeleton-kpi-item"></div>
          <div class="skeleton-kpi-item"></div>
          <div class="skeleton-kpi-item"></div>
        </div>
      </div>
    </div>
    <div class="cfi-panel" data-area="pricechart">
      <div class="cfi-strip">Share Price ‚Äî Historical &amp; Forecast</div>
      <div id="cfi-forecast" class="cfi-body tight plot"></div>
    </div>

    <div class="cfi-panel" data-area="trend">
      <div class="cfi-strip">Trend Explorer</div>
      <div class="cfi-body trend-body">
        <form id="cfi-trend-form" class="trend-form">
          <label for="cfi-trend-metric">Metric</label>
          <select id="cfi-trend-metric"></select>
          <label for="cfi-trend-view">View</label>
          <select id="cfi-trend-view">
            <option value="absolute">Absolute</option>
            <option value="growth">Growth %</option>
          </select>
          <button type="submit">Apply</button>
        </form>
        <div id="cfi-trend-chart" class="trend-chart plot"></div>
      </div>
    </div>

    <div class="cfi-panel" data-area="peers">
      <div class="cfi-strip">Peer Comparison</div>
      <div class="cfi-body peers-body">
        <form id="cfi-peer-form" class="peer-form">
          <label for="cfi-peer-group">Peer Group</label>
          <select id="cfi-peer-group"></select>
          <label for="cfi-peer-custom">Custom Tickers (comma separated)</label>
          <input id="cfi-peer-custom" type="text" placeholder="e.g. MSFT, GOOGL, NVDA"/>
          <button type="submit">Update Peers</button>
        </form>
        <div id="cfi-peer-status" class="peer-status"></div>
        <div id="cfi-peer-compare" class="peer-compare embed"></div>
      </div>
    </div>

    <div class="cfi-panel" data-area="rev">
      <div class="cfi-strip">Revenue vs EV/Revenue</div>
      <div id="cfi-rev" class="cfi-body tight plot"></div>
    </div>
    <div class="cfi-panel" data-area="ebitda">
      <div class="cfi-strip">EBITDA vs EV/EBITDA</div>
      <div id="cfi-ebitda" class="cfi-body tight plot"></div>
    </div>
    <div class="cfi-panel" data-area="valbar">
      <div class="cfi-strip">Valuation Summary ‚Äî Equity Value per Share ($)</div>
      <div id="cfi-valbar" class="cfi-body tight plot"></div>
    </div>
  </div>

  <div id="cfi-drilldown" class="cfi-drilldown hidden">
    <div class="cfi-drilldown__overlay" data-action="close-drilldown"></div>
    <div class="cfi-drilldown__panel">
      <button class="cfi-drilldown__close" data-action="close-drilldown" aria-label="Close drilldown">&times;</button>
      <div class="cfi-drilldown__content" id="cfi-drilldown-content"></div>
    </div>
  </div>

  <!-- Improvement #10: Export Preview Modal -->
  <div id="export-preview-modal" class="modal-overlay" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3 id="export-modal-title">Export Preview</h3>
        <button class="modal-close" aria-label="Close" onclick="document.getElementById('export-preview-modal').style.display='none'">&times;</button>
      </div>
      <div class="modal-body">
        <div class="export-preview-content" id="export-preview-content">
          <div class="preview-info">
            <div class="preview-item">
              <span class="preview-label">Format:</span>
              <span id="preview-format">PDF</span>
            </div>
            <div class="preview-item">
              <span class="preview-label">Company:</span>
              <span id="preview-company">-</span>
            </div>
            <div class="preview-item">
              <span class="preview-label">Estimated Size:</span>
              <span id="preview-size">~2.5 MB</span>
            </div>
            <div class="preview-item">
              <span class="preview-label">Includes:</span>
              <ul id="preview-includes">
                <li>Executive summary</li>
                <li>Financial metrics</li>
                <li>Charts and visualizations</li>
                <li>Data sources</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-button secondary" onclick="document.getElementById('export-preview-modal').style.display='none'">Cancel</button>
        <button class="modal-button primary" id="confirm-export-btn">Download</button>
      </div>
    </div>
  </div>

  <!-- Improvement #7: Error/Retry UI Template -->
  <template id="error-template">
    <div class="error-state">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h4 class="error-title">Unable to Load Data</h4>
      <p class="error-message"></p>
      <button class="retry-button">Retry</button>
    </div>
  </template>

  <!-- Keyboard Shortcuts Help -->
  <div id="keyboard-shortcuts-modal" class="modal-overlay" style="display: none;">
    <div class="modal-dialog shortcuts-dialog">
      <div class="modal-header">
        <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
        <button class="modal-close" aria-label="Close" onclick="document.getElementById('keyboard-shortcuts-modal').style.display='none'">&times;</button>
      </div>
      <div class="modal-body">
        <div class="shortcuts-grid">
          <div class="shortcut-item">
            <kbd>/</kbd>
            <span>Focus search</span>
          </div>
          <div class="shortcut-item">
            <kbd>R</kbd>
            <span>Refresh data</span>
          </div>
          <div class="shortcut-item">
            <kbd>E</kbd>
            <span>Export dashboard</span>
          </div>
          <div class="shortcut-item">
            <kbd>Esc</kbd>
            <span>Close modal</span>
          </div>
          <div class="shortcut-item">
            <kbd>1-6</kbd>
            <span>Toggle KPI categories</span>
          </div>
          <div class="shortcut-item">
            <kbd>?</kbd>
            <span>Show this help</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="cfi_dashboard.js?v=20241024b"></script>
  <script>
    (function demo(){
      if (!window.CFI) return;
      const payload = {
        meta:{
          brand:"amazon",
          company:"Amazon.com, Inc.",
          ticker:"AMZN",
          exchange:"NASDAQ",
          recommendation:"Buy",
          target_price:2024,
          scenario:"Consensus",
          website:"Amazon.com | Internet & Direct Marketing Retail",
          report_tag:"BenchmarkOS Equity Research",
          date:"2018-11-09"
        },
        price:{"Ticker":"NASDAQ: AMZN","Current Price":1755,"Target Price":2024,"TP Upside %":15.9,"IRR %":7.7},
        overview:{"Exchange":"NASDAQ","Sector":"Internet & Direct Marketing Retail","HQ":"Seattle, WA"},
        key_stats:{"Employees":850000,"Founded":1994,"CEO":"Andy Jassy","Primary Industry":"E-commerce"},
        market_data:{"Shares O/S (M)":5100,"Market Cap ($B)":1750,"Net Debt ($B)":17.4,"Enterprise Value ($B)":808.7},
        valuation_table:[
          {"Label":"Share Price","Market":1755,"DCF":2024,"Comps":2100},
          {"Label":"Enterprise Value ($B)","Market":808.7,"DCF":891.7,"Comps":834.2}
        ],
        key_financials:{
          columns:[2019,2020,2021,2022,2023],
          rows:[
            {"label":"Revenue","values":[280522,386064,469822,513983,574800]},
            {"label":"EBITDA (ex SBC)","values":[36931,48020,56523,60820,71500]},
            {"label":"Net income","values":[11588,21331,33364,-270,30500]},
            {"label":"Net profit margin","values":[4.1,5.5,7.1,-0.1,5.3],"type":"percent"},
            {"label":"Free cash flow","values":[25329,29620,36284,42262,65489]},
            {"label":"EV/Revenue (√ó)","values":[3.2,2.8,2.3,2.1,1.9],"type":"multiple"},
            {"label":"EV/EBITDA (√ó)","values":[18.0,15.2,13.5,12.3,11.0],"type":"multiple"}
          ]
        },
        kpi_summary:[
          {"label":"Revenue CAGR","value":0.17,"type":"percent","period":"3Y CAGR","source":"SEC filings"},
          {"label":"EPS CAGR","value":0.21,"type":"percent","period":"3Y CAGR","source":"SEC filings"},
          {"label":"EBITDA Growth","value":0.12,"type":"percent","period":"YoY","source":"BenchmarkOS model"},
          {"label":"EBITDA margin","value":0.178,"type":"percent","period":"TTM","source":"BenchmarkOS model"},
          {"label":"Operating margin","value":0.073,"type":"percent","period":"TTM","source":"BenchmarkOS model"},
          {"label":"Net margin","value":0.053,"type":"percent","period":"FY2023","source":"SEC filings"},
          {"label":"Profit margin","value":0.058,"type":"percent","period":"FY2023","source":"SEC filings"},
          {"label":"Return on assets","value":0.087,"type":"percent","period":"FY2023","source":"BenchmarkOS model"},
          {"label":"Return on equity","value":0.116,"type":"percent","period":"FY2023","source":"BenchmarkOS model"},
          {"label":"Return on invested capital","value":0.142,"type":"percent","period":"FY2023","source":"BenchmarkOS model"},
          {"label":"Free cash flow margin","value":0.114,"type":"percent","period":"TTM","source":"Company filings"},
          {"label":"Cash conversion","value":1.18,"type":"percent","period":"FY2023","source":"BenchmarkOS model"},
          {"label":"Debt to equity","value":1.3,"type":"multiple","period":"FY2023","source":"SEC filings"},
          {"label":"P/E (ttm)","value":112.0,"type":"multiple","period":"TTM","source":"Market data"},
          {"label":"EV/EBITDA (ttm)","value":31.0,"type":"multiple","period":"TTM","source":"Market data"},
          {"label":"P/B ratio","value":8.5,"type":"multiple","period":"FY2023","source":"Market data"},
          {"label":"PEG ratio","value":1.6,"type":"multiple","period":"FY2023","source":"Market data"},
          {"label":"Dividend yield","value":0.004,"type":"percent","period":"TTM","source":"Market data"},
          {"label":"Total shareholder return","value":0.245,"type":"percent","period":"1Y","source":"Market data"},
          {"label":"Share buyback intensity","value":0.018,"type":"percent","period":"FY2023","source":"Company filings"}
        ],
        kpi_series:{
          revenue_cagr:{type:"percent",years:[2021,2022,2023],values:[0.15,0.16,0.17]},
          eps_cagr:{type:"percent",years:[2021,2022,2023],values:[0.19,0.2,0.21]},
          ebitda_growth:{type:"percent",years:[2021,2022,2023],values:[0.09,0.11,0.12]},
          ebitda_margin:{type:"percent",years:[2021,2022,2023],values:[0.172,0.175,0.178]},
          operating_margin:{type:"percent",years:[2021,2022,2023],values:[0.069,0.071,0.073]},
          net_margin:{type:"percent",years:[2021,2022,2023],values:[0.044,0.048,0.053]},
          profit_margin:{type:"percent",years:[2021,2022,2023],values:[0.048,0.054,0.058]},
          return_on_assets:{type:"percent",years:[2021,2022,2023],values:[0.072,0.079,0.087]},
          return_on_equity:{type:"percent",years:[2021,2022,2023],values:[0.102,0.109,0.116]},
          return_on_invested_capital:{type:"percent",years:[2021,2022,2023],values:[0.128,0.135,0.142]},
          free_cash_flow_margin:{type:"percent",years:[2021,2022,2023],values:[0.098,0.106,0.114]},
          cash_conversion:{type:"percent",years:[2021,2022,2023],values:[1.05,1.12,1.18]},
          debt_to_equity:{type:"multiple",years:[2021,2022,2023],values:[1.5,1.4,1.3]},
          pe_ratio:{type:"multiple",years:[2021,2022,2023],values:[78.0,92.0,112.0]},
          ev_ebitda:{type:"multiple",years:[2021,2022,2023],values:[36.0,34.0,31.0]},
          pb_ratio:{type:"multiple",years:[2021,2022,2023],values:[9.8,9.1,8.5]},
          peg_ratio:{type:"multiple",years:[2021,2022,2023],values:[1.9,1.8,1.6]},
          dividend_yield:{type:"percent",years:[2021,2022,2023],values:[0.003,0.0035,0.004]},
          tsr:{type:"percent",years:[2021,2022,2023],values:[0.18,0.21,0.245]},
          share_buyback_intensity:{type:"percent",years:[2021,2022,2023],values:[0.012,0.015,0.018]}
        },
        interactions:{
          kpis:{
            default_mode:"trend",
            drilldowns:[
              {id:"revenue_cagr",label:"Revenue CAGR",default_view:"trend",data_refs:{series:"kpi_series.revenue_cagr",summary_id:"revenue_cagr"}},
              {id:"eps_cagr",label:"EPS CAGR",default_view:"trend",data_refs:{series:"kpi_series.eps_cagr",summary_id:"eps_cagr"}},
              {id:"ebitda_growth",label:"EBITDA Growth",default_view:"trend",data_refs:{series:"kpi_series.ebitda_growth",summary_id:"ebitda_growth"}}
            ]
          },
          charts:{controls:{modes:["absolute","growth"],default:"absolute"}},
          sources:{enabled:true,types:["filing","market_data","derived"]}
        },
        peer_config:{
          focus_ticker:"AMZN",
          default_peer_group:"benchmark",
          max_peers:5,
          supports_custom:true,
          available_peer_groups:[
            {id:"benchmark",label:"S&P 500 Avg",tickers:[]},
            {id:"custom",label:"Custom selection",tickers:[]}
          ]
        },
        sources:[
          {label:"Revenue",period:"FY2023",source:"SEC 10-K 2023",value:574800},
          {label:"Net income",period:"FY2023",source:"SEC 10-K 2023",value:30500},
          {label:"Free cash flow",period:"FY2023",source:"Company filings",value:65489},
          {label:"Shares O/S (M)",period:"FY2023",source:"Market data snapshot",value:5100},
          {label:"Net margin",period:"FY2023",source:"BenchmarkOS derived",value:0.053}
        ],
        charts:{
          revenue_ev:{Year:[2019,2020,2021,2022,2023], Revenue:[280522,386064,469822,513983,574800], EV_Rev:[3.2,2.8,2.3,2.1,1.9]},
          ebitda_ev:{Year:[2019,2020,2021,2022,2023], EBITDA:[36931,48020,56523,60820,71500], EV_EBITDA:[18.0,15.2,13.5,12.3,11.0]},
          forecast:{Year:[2013,2015,2017,2019,2021,2023,2025,2027,2029], Bull:[400,600,900,1200,1500,2100,2400,2700,3000], Base:[380,520,800,1100,1400,1850,2050,2250,2450], Bear:[360,480,700,950,1200,1600,1700,1850,2000]},
          valuation_bar:{Case:["DCF - Consensus","DCF - Bull","DCF - Bear","Comps","52-Week Hi/Lo"], Value:[2921,4136,918,2216,1755]}
        },
        valuation_data:{current:1755,average:2031,notes:["Football Field Chart","DCF - Consensus Case","DCF - Bull Case","DCF - Bear Case","Comps","52-Week Hi/Lo"]}
      };
      window.CFI.render(payload);
    })();
  </script>
</body>
</html>
