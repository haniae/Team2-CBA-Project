:root {
  --navy: #0b2e59;
  --accent: #1c7ed6;
  --orange: #ff7f0e;
  --muted: #5b6b82;
  --grid: #dce4f4;
  --bg: #f3f7fc;
  --card: #ffffff;
  --shadow: 0 6px 18px rgba(11, 46, 89, 0.08);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--navy);
  font: 12px "Inter", "Open Sans", Roboto, system-ui, -apple-system, "Segoe UI";
}

#cfi-root {
  max-width: 1280px;
  margin: 18px auto 24px;
  padding: 16px 18px 24px;
  display: grid;
  grid-gap: 12px;
  grid-template-columns: repeat(12, 1fr);
  grid-template-rows: auto 166px 320px 220px 220px 260px;
  grid-template-areas:
    "header header header header header header header header header header header header"
    "overview overview overview overview overview overview valuation valuation valuation valuation valuation valuation"
    "keyfin keyfin keyfin keyfin keyfin keyfin keyfin keyfin pricechart pricechart pricechart pricechart"
    "kpi kpi kpi kpi kpi kpi kpi kpi kpi kpi kpi kpi"
    "trend trend trend trend trend trend peers peers peers peers peers peers"
    "rev rev rev rev ebitda ebitda ebitda ebitda valbar valbar valbar valbar";
  background: #ffffff;
  border-radius: 8px;
  border: 1px solid var(--grid);
  box-shadow: 0 10px 24px rgba(11, 46, 89, 0.06);
}

.cfi-panel {
  background: var(--card);
  border: 1px solid var(--grid);
  border-radius: 8px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.cfi-panel[data-area="header"] {
  grid-area: header;
}

.cfi-panel[data-area="overview"] {
  grid-area: overview;
}

.cfi-panel[data-area="valuation"] {
  grid-area: valuation;
}

.cfi-panel[data-area="keyfin"] {
  grid-area: keyfin;
}

.cfi-panel[data-area="kpi"] {
  grid-area: kpi;
}

.cfi-panel[data-area="pricechart"] {
  grid-area: pricechart;
}

.cfi-panel[data-area="trend"] {
  grid-area: trend;
}

.cfi-panel[data-area="peers"] {
  grid-area: peers;
}

.cfi-panel[data-area="rev"] {
  grid-area: rev;
}

.cfi-panel[data-area="ebitda"] {
  grid-area: ebitda;
}

.cfi-panel[data-area="valbar"] {
  grid-area: valbar;
}

.cfi-header {
  padding: 16px 20px 12px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.header-top {
  display: grid;
  grid-template-columns: 240px 1fr auto 180px;
  align-items: center;
  gap: 18px;
}

.brand-stack {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.brand-row {
  display: flex;
  align-items: baseline;
  gap: 10px;
}

.brand-badge {
  position: relative;
  font-size: 24px;
  font-weight: 800;
  text-transform: lowercase;
  letter-spacing: 0.4px;
  color: var(--navy);
  padding-bottom: 2px;
}

.brand-badge::after {
  content: "";
  position: absolute;
  left: 0;
  bottom: 0;
  width: 42px;
  height: 3px;
  background: var(--orange);
  border-radius: 2px;
}

.brand-ticker {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.45px;
  color: var(--muted);
}

.header-actions {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 8px;
}

.export-button {
  border: none;
  border-radius: 18px;
  background: var(--navy);
  color: #ffffff;
  padding: 6px 14px;
  font: 600 11px/1 "Inter", "Open Sans", Roboto;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  cursor: pointer;
  transition: background 0.2s ease, transform 0.2s ease, opacity 0.2s ease;
}

.export-button:hover {
  background: #123d73;
  transform: translateY(-1px);
}

.export-button:disabled,
.export-button.loading {
  background: #9aa8bf;
  cursor: default;
  opacity: 0.8;
  transform: none;
}

.brand-company {
  font-size: 12px;
  font-weight: 600;
  color: var(--navy);
}

.header-title h1 {
  margin: 0 0 6px;
  font-size: 20px;
  font-weight: 800;
  letter-spacing: 0.3px;
  color: var(--navy);
}

.header-meta {
  display: flex;
  gap: 18px;
}

.meta-item {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.meta-label {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  color: var(--muted);
}

.meta-value {
  font-size: 14px;
  font-weight: 700;
  color: var(--navy);
}

.header-side {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: flex-end;
}

.cfi-logo {
  font-size: 24px;
  font-weight: 800;
  color: var(--navy);
  letter-spacing: 0.6px;
}

.header-subline {
  display: flex;
  gap: 16px;
  font-size: 11px;
  color: var(--muted);
  letter-spacing: 0.2px;
  padding-top: 6px;
  border-top: 1px solid #e9eef9;
}

.header-subline span + span::before {
  content: "•";
  margin: 0 6px;
  color: var(--grid);
}

.pill {
  display: inline-block;
  padding: 2px 10px;
  border-radius: 12px;
  background: rgba(28, 126, 214, 0.1);
  border: 1px solid rgba(28, 126, 214, 0.25);
  color: var(--navy);
}

.cfi-strip {
  height: 26px;
  background: var(--navy);
  color: #ffffff;
  font: 700 11px/26px "Inter", "Open Sans", Roboto;
  text-transform: uppercase;
  letter-spacing: 0.35px;
  padding: 0 10px;
}

.cfi-body {
  padding: 10px 12px;
}

.cfi-body.tight {
  padding: 8px 10px;
}

.plot {
  width: 100%;
  height: 220px;
}

.overview-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 10px;
}

.overview-column {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.overview-column h3 {
  margin: 0;
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.25px;
  color: var(--navy);
}

.overview-table {
  width: 100%;
  border-collapse: collapse;
  font: 500 12px/20px "Inter", "Open Sans", Roboto;
}

.overview-table tr + tr td {
  border-top: 1px solid #e8effa;
}

.overview-table .kv-label {
  color: var(--muted);
  text-transform: capitalize;
}

.overview-table .kv-value {
  text-align: right;
  font-variant-numeric: tabular-nums lining-nums;
  color: var(--navy);
}

.valuation-grid {
  display: grid;
  grid-template-columns: minmax(0, 1fr) 200px;
  gap: 16px;
}

.valuation-table {
  width: 100%;
  border-collapse: collapse;
  font: 500 12px/20px "Inter", "Open Sans", Roboto;
}

.valuation-table thead th {
  background: #f3f6ff;
  border-bottom: 1px solid var(--grid);
  padding: 6px 8px;
  text-align: right;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.valuation-table thead th:first-child {
  text-align: left;
}

.valuation-table td {
  padding: 6px 8px;
  border-bottom: 1px solid #eef2fb;
  text-align: right;
  font-variant-numeric: tabular-nums lining-nums;
}

.valuation-table td:first-child {
  text-align: left;
  font-weight: 600;
  color: #243554;
}

.valuation-list {
  list-style: none;
  margin: 0;
  padding: 8px 0 0 16px;
  font: 500 12px/18px "Inter", "Open Sans", Roboto;
  color: var(--muted);
  border-left: 1px solid var(--grid);
}

.valuation-list li {
  position: relative;
  padding: 2px 0;
}

.valuation-list li::before {
  content: "•";
  position: absolute;
  left: -12px;
  color: var(--navy);
}

.cfi-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  table-layout: fixed;
  font: 500 12px/22px "Inter", "Open Sans", Roboto;
}

.cfi-table colgroup col:first-child {
  width: 220px;
}

.cfi-table thead th {
  position: sticky;
  top: 0;
  z-index: 2;
  background: #f3f6ff;
  color: var(--navy);
  border-bottom: 1px solid var(--grid);
  font: 700 11px/26px "Inter", "Open Sans", Roboto;
  text-align: right;
  padding: 0 8px;
}

.cfi-table thead th:first-child {
  position: sticky;
  left: 0;
  text-align: left;
  z-index: 3;
}

.cfi-table tbody td {
  border-bottom: 1px solid #eef2fb;
  padding: 0 8px;
  height: 22px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.cfi-table tbody tr:nth-child(even) {
  background: #f9fbff;
}

.cfi-table .metric {
  position: sticky;
  left: 0;
  background: inherit;
  font-weight: 600;
  color: #243554;
}

.cfi-table .num {
  text-align: right;
  font-variant-numeric: tabular-nums lining-nums;
}

.cfi-kpi-grid {
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 12px;
}

.cfi-kpi-item {
  background: #f8fbff;
  border: 1px solid var(--grid);
  border-radius: 8px;
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.cfi-kpi-label {
  font: 600 10px/1.2 "Inter", "Open Sans", Roboto;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: var(--muted);
}

.cfi-kpi-value {
  font: 700 18px/1.2 "Inter", "Open Sans", Roboto;
  color: var(--navy);
  font-variant-numeric: tabular-nums lining-nums;
}

.cfi-kpi-value.positive {
  color: var(--accent);
}

.cfi-kpi-value.negative {
  color: var(--orange);
}

.trend-body,
.peers-body {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.trend-form,
.peer-form {
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 8px;
  align-items: end;
}

.trend-form label,
.peer-form label {
  font: 600 11px/1.4 "Inter", "Open Sans", Roboto;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--muted);
}

.trend-form select,
.peer-form select,
.peer-form input {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--grid);
  border-radius: 6px;
  font: 12px "Inter", "Open Sans", Roboto;
}

.trend-form button,
.peer-form button {
  justify-self: start;
  padding: 8px 14px;
  border: none;
  border-radius: 6px;
  background: var(--accent);
  color: #fff;
  font: 600 12px "Inter", "Open Sans", Roboto;
  cursor: pointer;
  transition: background 0.2s ease, transform 0.2s ease;
}

.trend-form button:hover,
.peer-form button:hover {
  background: #155da6;
  transform: translateY(-1px);
}

.trend-chart {
  min-height: 240px;
}

.peer-status {
  font: 12px "Inter", "Open Sans", Roboto;
  color: var(--muted);
}

.peer-compare {
  min-height: 320px;
  background: #f9fbff;
  border: 1px dashed var(--grid);
  border-radius: 8px;
  overflow: hidden;
}

.peer-compare .cfi-error {
  padding: 24px;
}

.cfi-drilldown {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.cfi-drilldown.visible {
  display: flex;
}

.cfi-drilldown.hidden {
  display: none;
}

.cfi-drilldown__overlay {
  position: absolute;
  inset: 0;
  background: rgba(11, 46, 89, 0.55);
}

.cfi-drilldown__panel {
  position: relative;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 18px 46px rgba(11, 46, 89, 0.22);
  width: min(840px, 92vw);
  max-height: 90vh;
  overflow-y: auto;
  padding: 24px 28px 32px;
  z-index: 1;
  display: flex;
  flex-direction: column;
  gap: 18px;
}

.cfi-drilldown__close {
  position: absolute;
  top: 12px;
  right: 12px;
  background: none;
  border: none;
  font-size: 26px;
  line-height: 1;
  color: var(--muted);
  cursor: pointer;
}

.cfi-drilldown__content h2 {
  margin: 0;
  font: 600 20px "Inter", "Open Sans", Roboto;
  color: var(--navy);
}

.drilldown-meta {
  font: 12px "Inter", "Open Sans", Roboto;
  color: var(--muted);
}

.drilldown-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 12px;
}

.drilldown-card {
  border: 1px solid var(--grid);
  border-radius: 8px;
  padding: 12px 14px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  background: #f9fbff;
}

.drilldown-card label {
  font: 600 10px/1 "Inter", "Open Sans", Roboto;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--muted);
}

.drilldown-card strong {
  font: 600 16px "Inter", "Open Sans", Roboto;
  color: var(--navy);
}

.drilldown-series {
  min-height: 260px;
}

.drilldown-table {
  width: 100%;
  border-collapse: collapse;
  font: 12px "Inter", "Open Sans", Roboto;
}

.drilldown-table th,
.drilldown-table td {
  border: 1px solid var(--grid);
  padding: 6px 8px;
  text-align: right;
}

.drilldown-table th:first-child,
.drilldown-table td:first-child {
  text-align: left;
}

.cfi-kpi-meta {
  font: 500 10px/1.2 "Inter", "Open Sans", Roboto;
  color: #7080a3;
}

.cfi-kpi-empty {
  text-align: center;
  color: var(--muted);
  font-weight: 600;
  padding: 24px 0;
}

@media (max-width: 1100px) {
  #cfi-root {
    grid-template-rows: auto;
    grid-template-areas:
      "header header header header header header header header header header header header"
      "overview overview overview overview overview overview valuation valuation valuation valuation valuation valuation"
      "keyfin keyfin keyfin keyfin keyfin keyfin keyfin keyfin keyfin keyfin keyfin keyfin"
      "kpi kpi kpi kpi kpi kpi kpi kpi kpi kpi kpi kpi"
      "trend trend trend trend trend trend peers peers peers peers peers peers"
      "pricechart pricechart pricechart pricechart pricechart pricechart pricechart pricechart pricechart pricechart pricechart pricechart"
      "rev rev rev rev rev rev rev rev rev rev rev rev"
      "ebitda ebitda ebitda ebitda ebitda ebitda ebitda ebitda ebitda ebitda ebitda ebitda"
      "valbar valbar valbar valbar valbar valbar valbar valbar valbar valbar valbar valbar";
  }

  .trend-form,
  .peer-form {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .cfi-kpi-grid {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }

  .plot {
    height: 200px;
  }
}

@media (max-width: 768px) {
  #cfi-root {
    margin: 12px;
    padding: 12px;
    grid-template-columns: 1fr;
    grid-template-areas:
      "header"
      "overview"
      "valuation"
      "keyfin"
      "kpi"
      "trend"
      "peers"
      "pricechart"
      "rev"
      "ebitda"
      "valbar";
  }

  .cfi-header {
    padding: 14px 14px 10px;
    gap: 10px;
  }

  .header-top {
    grid-template-columns: 1fr;
    align-items: flex-start;
  }

  .header-actions {
    justify-content: flex-start;
    flex-wrap: wrap;
  }

  .export-button {
    flex: 1 1 calc(50% - 6px);
    text-align: center;
  }

  .header-meta {
    flex-wrap: wrap;
    gap: 12px;
  }

  .header-side {
    align-items: flex-start;
  }

  .header-subline {
    flex-direction: column;
    gap: 4px;
  }

  .overview-grid {
    grid-template-columns: 1fr;
  }

  .valuation-grid {
    grid-template-columns: 1fr;
  }

  .cfi-kpi-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .trend-form,
  .peer-form {
    grid-template-columns: 1fr;
  }

  .cfi-drilldown__panel {
    width: 94vw;
    padding: 20px;
  }
}

@media (max-width: 520px) {
  .cfi-kpi-grid {
    grid-template-columns: 1fr;
  }

  .export-button {
    flex: 1 1 100%;
  }

  .trend-form button,
  .peer-form button {
    width: 100%;
  }
}
